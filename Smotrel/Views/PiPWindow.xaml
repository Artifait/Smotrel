<Window x:Class="Smotrel.Views.PiPWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Smotrel.Views"
        mc:Ignorable="d"
        Title="PiP" Width="420" Height="240"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent" Topmost="True"
        ResizeMode="CanResizeWithGrip" ShowInTaskbar="False"
        WindowStartupLocation="Manual">

    <Window.Resources>
        <!-- Кнопки (копия из MainWindow) -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- Slider style (копия из MainWindow) -->
        <Style TargetType="Slider">
            <Setter Property="Foreground" Value="#FFDD00"/>
            <Setter Property="Background" Value="#333"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid>
                            <Track x:Name="PART_Track">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="Slider.DecreaseLarge"
                                                  Background="#FFDD00"
                                                  Height="4" Margin="0"/>
                                </Track.DecreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Width="12" Height="12" Background="#FFDD00" BorderBrush="Black" BorderThickness="1"/>
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="Slider.IncreaseLarge"
                                                  Background="#333"
                                                  Height="4" Margin="0"/>
                                </Track.IncreaseRepeatButton>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border Background="#CC111111" CornerRadius="8" Padding="6">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <!-- video -->
                <RowDefinition Height="Auto" />
                <!-- overlay controls -->
            </Grid.RowDefinitions>

            <!-- MediaElement area -->
            <MediaElement x:Name="PiPPlayerControl"
                          Grid.Row="0"
                          LoadedBehavior="Manual"
                          UnloadedBehavior="Stop"
                          Stretch="UniformToFill"/>

            <!-- Compact resume banner top-right -->
            <Border x:Name="PiPResumeBanner" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Top"
                    Background="#AA111111" Padding="6" CornerRadius="6" Visibility="Collapsed" Margin="0,6,6,0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="PiPResumeText" Text="Продолжить с 0:00?" VerticalAlignment="Center" FontSize="12" Margin="0,0,6,0"/>
                    <Button x:Name="PiPBtnResume" Click="PiPBtnResume_Click" Content="▶" Width="36" Height="24" Margin="0,0,4,0"/>
                    <Button x:Name="PiPBtnClearResume" Click="PiPBtnClearResume_Click" Content="✖" Width="28" Height="24"/>
                </StackPanel>
            </Border>

            <!-- Bottom controls -->
            <StackPanel Grid.Row="1" Orientation="Vertical" Background="#80000000" Margin="0,8,0,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Slider x:Name="PiPVideoSlider" Grid.Column="0" Minimum="0" Maximum="100"
                            PreviewMouseDown="PiPSlider_PreviewMouseDown"
                            PreviewMouseUp="PiPSlider_PreviewMouseUp"/>

                    <TextBlock x:Name="PiPTimeText" Grid.Column="1" VerticalAlignment="Center" Foreground="White" Margin="8,0,0,0" Text="0:00 / 0:00"/>
                </Grid>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6,0,0">
                    <Button x:Name="PiPPrevBtn" Click="PiPPrevBtn_Click" Content="⏮" Width="36"/>
                    <Button x:Name="PiPPlayPauseBtn" Click="PiPPlayPauseBtn_Click" Content="⏸" Width="48" Margin="6,0"/>
                    <Button x:Name="PiPNextBtn" Click="PiPNextBtn_Click" Content="⏭" Width="36"/>

                    <!-- Volume -->
                    <StackPanel Orientation="Horizontal" Margin="12,0" VerticalAlignment="Center">
                        <TextBlock Text="🔊" VerticalAlignment="Center" Margin="0,0,6,0" Foreground="White"/>
                        <Slider x:Name="PiPVolumeSlider" Width="90" Minimum="0" Maximum="1" ValueChanged="PiPVolumeSlider_ValueChanged"/>
                    </StackPanel>

                    <!-- Rate combobox -->
                    <ComboBox x:Name="PiPRateCombo" Width="70" Margin="12,0" VerticalAlignment="Center"/>

                    <!-- Restore/Close (returns to main window) -->
                    <Button x:Name="PiPRestoreBtn" Click="PiPRestoreBtn_Click" Content="⤴" Margin="8,0"/>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Border>
</Window>