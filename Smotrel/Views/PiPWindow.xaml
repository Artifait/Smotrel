<Window x:Class="Smotrel.Views.PiPWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PiP" Width="420" Height="260"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent" Topmost="True"
        ResizeMode="CanResizeWithGrip" ShowInTaskbar="False"
        WindowStartupLocation="Manual"
        SizeChanged="Window_SizeChanged">

    <Border x:Name="RootBorder" Background="#CC111111" CornerRadius="8" Padding="6">
        <Grid x:Name="RootGrid">
            <!-- Теперь три строки: видео, фиксированный gap, bottom controls -->
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="0"/>
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- MediaElement area -->
            <Grid Grid.Row="0" ClipToBounds="True" MouseDown="Grid_MouseDown">
                <MediaElement x:Name="PiPPlayerControl"
                              LoadedBehavior="Manual"
                              UnloadedBehavior="Stop"
                              Stretch="Uniform"
                              MouseLeftButtonDown="PiPPlayPauseBtn_Click"/>
            </Grid>

            <!-- Compact resume banner top-right -->
            <Border x:Name="PiPResumeBanner" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Top"
                    Background="#AA111111" Padding="6" CornerRadius="6" Visibility="Collapsed" Margin="0,6,6,0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="PiPResumeText" Text="Продолжить с 0:00?" VerticalAlignment="Center" FontSize="12" Margin="0,0,6,0"/>
                    <Button x:Name="PiPBtnResume" Click="PiPBtnResume_Click" Content="▶" Width="36" Height="24" Margin="0,0,4,0"/>
                    <Button x:Name="PiPBtnClearResume" Click="PiPBtnClearResume_Click" Content="✖" Width="28" Height="24"/>
                </StackPanel>
            </Border>

            <StackPanel x:Name="PiPBottomControls" Grid.Row="2" Orientation="Vertical" Background="#80000000" Margin="0"  MouseDown="Grid_MouseDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Slider x:Name="PiPVideoSlider" Grid.Column="0" Minimum="0" Maximum="100"
                            PreviewMouseDown="PiPSlider_PreviewMouseDown"
                            PreviewMouseUp="PiPSlider_PreviewMouseUp"/>

                    <TextBlock x:Name="PiPTimeText" Foreground="White" Grid.Column="1" VerticalAlignment="Center" Margin="8,0,0,0" Text="0:00 / 0:00"/>
                </Grid>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6,0,6">
                    <Button x:Name="PiPPrevBtn" Click="PiPPrevBtn_Click" Content="⏮" Width="36"/>
                    <Button x:Name="PiPPlayPauseBtn" Click="PiPPlayPauseBtn_Click" Content="⏸" Width="48" Margin="6,0"/>
                    <Button x:Name="PiPNextBtn" Click="PiPNextBtn_Click" Content="⏭" Width="36"/>

                    <StackPanel Orientation="Horizontal" Margin="12,0" VerticalAlignment="Center">
                        <TextBlock Text="🔊" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <Slider x:Name="PiPVolumeSlider" Width="90" Minimum="0" Maximum="1" ValueChanged="PiPVolumeSlider_ValueChanged"/>
                    </StackPanel>

                    <ComboBox x:Name="PiPRateCombo" Width="70" Margin="12,0" VerticalAlignment="Center"/>

                    <Button x:Name="PiPRestoreBtn" Click="PiPRestoreBtn_Click" Content="⤴" Margin="8,0"/>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Border>
</Window>
